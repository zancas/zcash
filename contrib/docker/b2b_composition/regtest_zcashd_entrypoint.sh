#! /bin/bash

MEMO="f600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set -ex
/usr/bin/zcashd -printtoconsole &
sleep 6
COINBASE_ZADDR=`/usr/bin/zcash-cli z_getnewaddress`
/usr/bin/zcash-cli stop
sleep 6
/usr/bin/zcashd -printtoconsole -mineraddress=$COINBASE_ZADDR &
sleep 6
/usr/bin/zcash-cli --verbose generate 10
RECEIVING_ZADDR=`/usr/bin/zcash-cli z_getnewaddress`
SEND_OPERATION_ID=`/usr/bin/zcash-cli z_sendmany "$COINBASE_ZADDR" '[{"address": "'$RECEIVING_ZADDR'", "amount": 1.0, "memo": "'$MEMO'"}]'`
#OP_STATUS=`/usr/bin/zcash-cli z_getoperationstatus '["'$SEND_OPERATION_ID'"]'`
wait
